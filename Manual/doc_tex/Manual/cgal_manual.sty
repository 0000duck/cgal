% +------------------------------------------------------------------------+
% | cgal_manual.sty
% | Common style files and definitions for CGAL User and Reference Manuals
% +------------------------------------------------------------------------+

% Style files used throughout the manuals
% used with LaTeX and also understood by the LaTeX to HTML Converter
\usepackage{cc_manual}
\usepackage{cc_manual_index}
\usepackage{latex_to_html}
\usepackage{path}
\usepackage{alltt}
\usepackage{cprog} % outdated
\usepackage{ifthen}

% used with LaTeX but _not_ understood by the converter
\lcTex{
  \usepackage{ifpdf}
  \usepackage{makeidx}
  \usepackage{amssymb}
  \usepackage{graphicx}
  \usepackage{epsfig}
  \usepackage{ipe}
  \usepackage{pslatex}
  \usepackage{psfrag}
  \usepackage{rotating}
  \usepackage{longtable}
}

% +------------------------------------------------------------------------+
% Configuration section begin ...
% +------------------------------------------------------------------------+

% CGAL release and date, adapt this to the current release
%\newcommand{\cgalrelease}{3.1-I}
% \newcommand{\cgalreleasedate}{November 2003} % use this for public releases
%\newcommand{\cgalreleasedate}{\today} % use this for internal releases

% Read version.tex for release number
\lcTex{\catcode`@=11}
\lcTex{\@input{version.tex}%
  \ifx\cgalversion\@ClearUndefdMacro \gdef\cgalversion{Separate Build}\else
    \xdef\cgalversion{Release \cgalversion}\fi
  \ifx\cgalversiondate\@ClearUndefdMacro \gdef\cgalversiondate{\today}\fi}
\lcTex{\catcode`@=12}

\lcHtml{\lciIfFileExists{version.tex}{\input{version.tex}}{}%
  \lciIfDefined{\cgalversion}%
    {\xdef\cgalTmpVersion{\cgalversion}%
      \gdef\cgalversion{Release \cgalTmpVersion}}%
    {\gdef\cgalversion{Separate Build}}%
  \lciIfDefined{\cgalversiondate}{}{\gdef\cgalversiondate{\today}}}


% minitoc and hyperref do not seem to work together so they should not both
% be true
\newboolean{useminitoc}
\setboolean{useminitoc}{true}

% We rather like a less dense table of contents (maybe HTML only)
\setcounter{secnumdepth}{2} % number subsections inclusively
\setcounter{tocdepth}{1}    % toc with sections inclusively

% Enable automatic check for C++ include files
\gdef\ccIfCheckInclude{\ccTrue}

% +------------------------------------------------------------------------+
% ... end configuration section.
% +------------------------------------------------------------------------+

% include hypperref for PDF documents
\lcTex{\ifpdf
  \pdfinfo{
    /Author   (CGAL Open Source Project)
    /Title    (CGAL Manuals)
    /Keywords (computational geometry;generic programming;algorithms;software library;C++)
  }
  % add option ps2pdf=true when using ps2pdf instead of pdflatex
  \usepackage[colorlinks=true,
              linkcolor=blue,
              bookmarksnumbered=true,
              pdfborder={0 0 0},
              pdfpagelabels=true,
              plainpages=false]{hyperref}%
%
% Enforce same character spacing in PDFLaTeX
\pdfadjustspacing=1
%
\fi
}


% include minitoc if selected above
\ifthenelse{\boolean{useminitoc}}{\lcTex{\usepackage{minitoc}}}
{\newcommand{\minitoc}{}}

% page dimensions
% ---------------
\lcTex{
  \textwidth 15.6cm
  \textheight 23 cm
  \topmargin -14mm
  \evensidemargin 3mm
  \oddsidemargin 3mm
  \marginparsep10mm   % needed for the tab-markers of reference pages
  \marginparwidth15mm
}

% Optionally, package authors and a package release can be shown
% right below the chapter title. Comment out the following lines
% to get back to the default behavior.
% -----------------------------------------------------------------
\def\ccTagChapterAuthor{\ccTrue}
% \def\ccTagChapterRelease{\ccTrue}

% default column layout
% ---------------------
\newcommand{\cgalcolumnlayout}{%
    \ccSetThreeColumns{CGAL_Oriented_side}{}{\hspace*{8.5cm}}%
    \ccPropagateThreeToTwoColumns}
% backwards compatible!
\newcommand{\cgalColumnLayout}{\cgalcolumnlayout}


% reinitialize some settings before each chapter
% ----------------------------------------------
\newcommand{\cgalreinit}{\cgalcolumnlayout\ccTagDefaults}

% The tab marker are aligned with the top of the main text. To align
% them with the page header, the following length definition can be used.
% -----------------------------------------------------------------------
%\setlength{\ccRefTabLift}{12.5mm}

% Be careful to check that other redefinitions of ccRefPageBegin and
% ccRefPageEnd don't cause strange problems
% (e.g. if ccAdvanced is used to bracket a ref page)
% -------------------------------------------------------------------------
\def\ccRefPageBegin{\ccParDims\cgalcolumnlayout}
\def\ccRefPageEnd{\ccParDims\cgalcolumnlayout}


% All identifiers reside in CGAL scope by default
% -----------------------------------------------
\ccDefGlobalScope{CGAL::}

% LaTeX settings
% --------------
% \makeindex  --> placed in wrapper

% make LaTeX process the whole manual without stopping for errors
% \batchmode  --> placed in wrapper

% relax formatting strictness to avoid many overfull \hbox's etc.
\sloppy

% Provide a default title page macro. Args: <package/module name>
% ---------------------------------------------------------------
\newcommand{\cgaltitlepage}[1]{%
  \pagestyle{empty}
  \begin{titlepage}\mbox{}\vspace{3cm}
  \lcTex{\centerline{%
      \includegraphics[scale=0.25]{Manual/fig/c-simp}~
      \includegraphics[scale=0.25]{Manual/fig/g-simp}~
      \includegraphics[scale=0.25]{Manual/fig/a-simp}~
      \includegraphics[scale=0.25]{Manual/fig/l-simp}}}
  \lcRawHtml{
  <p align=center>
    <img border="0" src="Manual/fig/cgal_small_FAF8E8.gif" align="center"
      alt="[Computational Geometry Algorithms Library]">
  </p>}
  \vspace{1cm}

%  \centerline{{\huge #1}}\vspace{2cm}
  \begin{center}{{\huge #1\par}}\end{center}

  \vspace{16mm}

  \centerline{{\Large \cgalversion}}\vspace{1cm}

  \centerline{{\Large \cgalversiondate}}
  \end{titlepage}
  \cleardoublepage
  \setcounter{page}{1}
  \pagestyle{plain}
}

% ----------- license ---------
\newcommand{\ccLicense}[1]{\ccRef[#1]{licenses:#1}}

\newcommand{\ccLicenseGPL}{ccLicense{GPL}}
\newcommand{\ccLicenseLGPL}{ccLicense{LGPL}}
\newcommand{\ccLicenseQPL}{ccLicense{QPL}}
\newcommand{\ccLicenseCommercial}{ccLicense{Commercial}}

% ----------- thirdparty ---------
\newcommand{\ccThirdParty}[1]{\ccRef[#1]{thirdparty:#1}}

\newcommand{\ccThirdPartyBoost}{\ccThirdParty{Boost}}
\newcommand{\ccThirdPartyCoin}{\ccThirdParty{Coin}}
\newcommand{\ccThirdPartyGMP}{\ccThirdParty{GMP}}
\newcommand{\ccThirdPartyLeda}{\ccThirdParty{Leda}}
\newcommand{\ccThirdPartyQt}{\ccThirdParty{Qt}}
\newcommand{\ccThirdPartySTL}{\ccRef[Standard Template Library]{thirdparty:stl}}
\newcommand{\ccThirdPartyTaucs}{\ccThirdParty{Taucs}}
\newcommand{\ccThirdPartyZlib}{\ccThirdParty{zlib}}


% Implement the two columns layout for the HTML converted part
% ------------------------------------------------------------

\lcTex{
  % Args: <package-name>
  % Remembers the package name, such that it can be tested later with
  % \cgalifpackage{<package-name>}{<yes-text>}{<no-text>}
  \newcommand{\cgaldeclarepackage}[1]{%
    \expandafter\xdef\csname CgalPackage#1\endcsname{Dummy}}
  % tex just ignores the user-ref-manual association
  \newcommand{\cgaldeclarepackageWithRef}[2]{\cgaldeclarepackage{#1}}

  % Args: <package-name>, <yes-text>, <no-text>
  % Tests, if <package-name> was previously declared with
  % \cgaldeclarepackage{<package-name>}, and if so expands the <yes-text>,
  % and otherwise expands the <no-text>
  \newcommand{\cgalifpackage}[3]{%
    \expandafter\ifx\csname CgalPackage#1\endcsname\relax #3\else #2\fi}

  \newcommand{\ccPkgName}[1]{}
  \newcommand{\ccPkgSummary}[1]{}
  \newcommand{\ccPkgMaturity}[1]{}
  \newcommand{\ccPkgDependsOn}[1]{}
  \newcommand{\ccPkgLicense}[1]{}
  \newenvironment{ccPkgDescription}{\ccPkgName}{}
}

\lcHtml{
  % Args: <package-name>
  % Remembers the package name, such that it can be tested later with
  % \cgalifpackage{<package-name>}{<yes-text>}{<no-text>}
  \newcommand{\cgaldeclarepackage}[1]{\gdef{\CgalPackage#G1}{Dummy}}
  \newcommand{\cgaldeclarepackageWithRef}[2]{\gdef{\CgalPackageHasRef#G1}{#2}}

  % Args: <package-name>, <yes-text>, <no-text>
  % Tests, if <package-name> was previously declared with
  % \cgaldeclarepackage{<package-name>}, and if so expands the <yes-text>,
  % and otherwise expands the <no-text>
  \newcommand{\cgalifpackage}[3]{\lciIfDefined{\CgalPackage#G1}{#2}{#3}}


  % ___________________________________________________________________________
  % ###########################################################################
  % |
  % |   o   Package Descriptions
  % |
  % ###########################################################################


  \gdef\ccValueofPkgName{}
  \newcommand{\ccPartSummary}[1]{#1}
  \newcommand{\ccPkgSummary}[1]{\gdef\ccValueofPkgSummary{#1\lcRawHtml{<br>}}}
  \newcommand{\ccPkgMaturity}[1]{\gdef\ccValueofPkgMaturity{\lcRawHtml{<b>Maturity: </b>}#1\lcRawHtml{<br>}}}
  \newcommand{\ccPkgDependsOn}[1]{\gdef\ccValueofPkgDependsOn{\lcRawHtml{<b>Depends on: </b>}#1\lcRawHtml{<br>}}}
  \newcommand{\ccPkgLicense}[1]{\gdef\ccValueofPkgDependsOn{\lcRawHtml{<b>License: </b>}#1\lcRawHtml{<br>}}}

  \newenvironment{ccPkgDescription}{\ccPkgDescriptionX}{\lciPopOutput}

  \newcommand{\ccPkgDescriptionX}[1]{
    \lciPushOutput{description}%
    \gdef\ccValueofPkgName{#1}
    \gdef\ccValueofPkgSummary{}
    \gdef\ccValueofPkgMaturity{}
    \gdef\ccValueofPkgDependsOn{}
    \gdef\ccValueofPkgLicense{}
  }

  \newcommand{\lciFlushPkgDescription}[2]{%
   \lciFlushPkgDescriptionX{#1}{#2}{\ccValueofPkgName}%
  }
  \newcommand{\lciFlushPkgDescriptionX}[3]{%
    \lciIfEmpty{#X3}{}{%
      \lciPushOutput{description}%
      \lcRawHtml{<h3>}\ccValueofPkgName\lcRawHtml{</h3>}
      \ccValueofPkgSummary
      \ccValueofPkgMaturity
      \ccValueofPkgDependsOn
      \ccValueofPkgLicense
      \lcRawHtml{<a href="#XC1">User Manual</a> &nbsp; <a href="#XC2">Reference Manual</a>}
      \lciPopOutput%
      \gdef\ccValueofPkgName{}%
    }%
  }

  \newcommand{\ccPartDescriptionEnsureHR}{}

  \newcommand{\ccPartDescriptionImpl}[2]{
    \lciPushOutput{description}%
    \ccPartDescriptionEnsureHR
    \lcRawHtml{<h2>}#1\lcRawHtml{</h2>}
    \def\ccValueofPkgSummary{}
    #2
    \ccValueofPkgSummary
    \lciPopOutput%
    \newcommand{\ccPartDescriptionEnsureHR}{\lcRawHtml{<hr>}}
  }


}

\lcHtml{\lcTwoColumnToc}%

% Group all \entryleft, \entryright, \entryleftright, \package... commands
% as argument to this macro.
\newcommand{\cgalchapters}[1]{%
  % make a first run over the argument
  % and declare \ifthen variables for packages
  \newcommand{\entry}[1]{}%
  \newcommand{\entryleft}[1]{}%
  \newcommand{\entryright}[1]{}%
  \newcommand{\entryleftright}[2]{}%
  \newcommand{\packageleft}[1]{\cgaldeclarepackage{##1}}%
  \newcommand{\packageright}[1]{\cgaldeclarepackage{##1}}%
  \newcommand{\packageleftright}[2]{%
    \cgaldeclarepackage{##1}\cgaldeclarepackage{##2}%
    \cgaldeclarepackageWithRef{##1}{##2}%
  }%
  \newcommand{\ccPartDescription}[2]{}
  #1
  \lcTex{%
    %\renewcommand{\entryleft}[1]{##1}%
    %\renewcommand{\entryright}[1]{}%
    %\renewcommand{\entryleftright}[2]{##1}%
    %\renewcommand{\packageleft}[1]{\cgalreinit\include{##1/main}}%
    %\renewcommand{\packageright}[1]{}%
    %\renewcommand{\packageleftright}[2]{\cgalreinit\include{##1/main}}%
    %#1
    %\renewcommand{\entryleft}[1]{}%
    %\renewcommand{\entryright}[1]{##1}%
    %\renewcommand{\entryleftright}[2]{##2}%
    %\renewcommand{\packageleft}[1]{}%
    %\renewcommand{\packageright}[1]{\cgalreinit\include{##1/main}}%
    %\renewcommand{\packageleftright}[2]{\cgalreinit\include{##2/main}}%
    %#1
    \renewcommand{\entry}[1]{##1}%
    \renewcommand{\entryleft}[1]{##1}%
    \renewcommand{\entryright}[1]{##1}%
    % should be deprecated, i suppose
    \renewcommand{\entryleftright}[2]{##1##2}%
    \renewcommand{\packageleft}[1]{\cgalreinit\include{##1/main}}%
    \renewcommand{\packageright}[1]{\cgalreinit\include{##1/main}}%
    \renewcommand{\packageleftright}[2]{\cgalreinit\include{##1/main}\cgalreinit\include{##2/main}}%
    #1
  }%
  \lcHtml{
    \newcommand{\ccPartDescription}{\ccPartDescriptionImpl}
    \newcommand{\entry}[1]{\lcTocCompleteRow ##1}
    \lciIfTwoColumnToc{
      \newcommand{\entryleft}[1]{\lcTocLeft ##1}%
      \newcommand{\entryright}[1]{\lcTocRight ##1}%
      \newcommand{\entryleftright}[2]{%
        \lcTocSync\lcTocLeft ##1\lcTocRight ##2\lcTocSync}%
      \newcommand{\packageleft}[1]{\lcTocLeft \cgalreinit\include{##1/main}}%
      \newcommand{\packageright}[1]{\lcTocRight \cgalreinit\include{##1/main}}%
      \newcommand{\packageleftright}[2]{%
        \lcTocSync%
        \lcTocLeft\cgalreinit\include{##1/main}%
        \edef\lciUsermanualOutputFilename{\lciOutputFilename}%
        \lcTocRight\cgalreinit\include{##2/main}%
        \lciFlushPkgDescription{\lciUsermanualOutputFilename}{\lciOutputFilename}
        \lcTocSync}%
      #1
    }{%
      \newcommand{\entryleft}[1]{##1}%
      \newcommand{\entryright}[1]{}%
      \newcommand{\entryleftright}[2]{##1}%
      \newcommand{\packageleft}[1]{\cgalreinit\include{##1/main}}%
      \newcommand{\packageright}[1]{}%
      \newcommand{\packageleftright}[2]{\cgalreinit\include{##1/main}}%
      #1
      \renewcommand{\entryleft}[1]{}%
      \renewcommand{\entryright}[1]{##1}%
      \renewcommand{\entryleftright}[2]{##2}%
      \renewcommand{\packageleft}[1]{}%
      \renewcommand{\packageright}[1]{\cgalreinit\include{##1/main}}%
      \renewcommand{\packageleftright}[2]{\cgalreinit\include{##2/main}}%
      #1
    }%
  }%
}



\lcTex{\catcode`@=11}
\lcTex{\@input{cgal_include_only.tex}}
\lcTex{\catcode`@=12}

\lcHtml{\lciIfFileExists{cgal_include_only.tex}{\input{cgal_include_only.tex}}{}}


% +------------------------------------------------------------------------+
% | end of cgal_manual.sty
% +------------------------------------------------------------------------+
