\begin{ccRefConcept}{CurveAnalysis_2::CurveVerticalLine_1}

\ccDefinition

The \ccc{CurveVerticalLine_1} concept is meant to provide information
about the intersections of a curve with a vertical line at a given 
finite $x$-coordinate. Note that a curve can have a vertical line component 
at this coordinate and non-vertical components may intersect 
the vertical line respectively. 
With the help of the concept's methods one is able
to compute the local topology of the curve at the given vertical line.
Note that vertical lines at $x = \pm\infty$ are not allowed, since different 
events (curve ends going to infinity with different non-horizontal asymptotes)
would have equal $y$-coordinate ($\pm\infty$), which confuses more than it
helps. Note in addition that curve ends approaching the vertical asymptote 
introduce an event (depending on whether approaching $+\infty$ or $-\infty$ -
but the event with coordinates $(x,-\infty)$, resp. $(x,+\infty)$, occur
only once, if they occur, and they imply not to be associated with
a instance of \ccc{Algebraic_real_2}.

\ccTypes

\ccNestedType{Algebraic_real_1}{A model of the concept
  \ccc{AlgebraicKernel_d_1::AlgebraicReal_1}.}

\ccNestedType{Algebraic_real_2}{A model of the concept
  \ccc{AlgebraicKernel_d_2::Algebraic_real_2}.}

\ccCreationVariable{fo}
\ccAccessFunctions

\ccMethod{Algebraic_real_1 x();}{
  returns the $x$-coordinate of the vertical line (always a finite value).
}

\ccMethod{bool covers_line();}{
  returns \ccc{true} in case the given curve contains the vertical line as
  a component
}

\ccMethod{unsigned int number_of_events();}{
  returns number of distinct and finite intersections of a curve with a 
  (intended) vertical line ignoring a real vertical line component 
  of the curve at the given $x$-coordinate.
}

\ccMethod{Algebraic_real_2 get_algebraic_real_2(int j);}{
  returns an object of type \ccc{Algebraic_real_2} for the $j$-th event
  \ccPrecond{$0 \leq j < \mbox{num\_events()}$}.
}

\ccMethod{std::pair< unsigned int, unsigned int > 
  get_number_of_incident_branches(int j);}{
  returns the number of branches of the curve connected to $j$-th event
  immediately to the left,
  to the right, respectively, as a pair of \ccc{unsigned int} ignoring 
  vertical curve components at the given $x$-coordinate.
  \ccPrecond{$0 \leq j < \mbox{num\_events()}$}
}

\ccMethod{std::pair< unsigned int, unsigned int > 
  get_number_of_branches_approaching_minus_infinity();}{
  returns the number of vertical asymptotes at $x$ 
  of the curve approaching $y=-\infty$
  from left and right. A vertical line being component of the curve is ignored.
}

\ccMethod{std::pair< unsigned int, unsigned int > 
  get_number_of_branches_approaching_plus_infinity();}{
  returns the number of vertical asymptotes at $x$ 
  of the curve approaching $y=+\infty$
  from left and right. A vertical line being component of the curve is ignored.
}

\ccMethod{bool is_event();}{
  returns \ccc{true} if curve has vertical line component or
  curve $f$ has intersection with $f_y$ at $x$
}

\end{ccRefConcept}

\begin{ccRefConcept}{AlgebraicKernel_d_2::CurveAnalysis_2}
\footnote{There is no need
for curves to be algebraic, hence the generic name. Only the number
of events must be finite.}

\ccDefinition

The \ccc{AlgebraicKernel_d_2::CurveAnalysis_2} 
concept is meant to provide tools to analyse a single
curve. An analysis is meant to describe the curve's interesting points and how 
they are connected. The analysis searches for {\it events}. Events only
occur at a finite number of $x$-coordinates. Each such coordinate defines
a \ccc{CurveVerticalLine_1} of an event. These coordinates also define open 
{\it intervals} on the $x$-axis. Different 
\ccc{CurveVerticalLine_1} at values within one 
such interval only differ in the values of the \ccc{Algebraic_real_2} entries. 
Topological information are equal for all $x$-coordinate inside such an
open interval. 

\ccRefines{
  \ccc{DefaultConstructible, CopyConstructible, Assignable}
}

\ccTypes

\ccNestedType{Algebraic_real_1}{A model of the concept
  \ccc{AlgebraicKernel_d_1::AlgebraicReal_1}.}

\ccNestedType{Algebraic_real_2}{A model of the concept
  \ccc{AlgebraicKernel_d_2::Algebraic_real_2}.}

\ccNestedType{Polynomial_2}{A model of the concept 
  \ccc{AlgebraicKernel_d_2::Polynomial_2}.}

\ccNestedType{Curve_vertical_line_1}{A model of the concept
\ccc{CurveAnalysis_2::CurveVerticalLine_1}.}

\ccCreation
\ccCreationVariable{fo}
        
\ccConstructor{CurveAnalysis_2(Polynomial_2 p);}
    {constructs an analysis for the curve defined by p. The polynomial must
      be square free.}

\begin{ccAdvanced}
\ccConstructor{template < class InputIterator >
  CurveAnalysis_2(Polynomial_2 p, InputIterator begin, InputIterator end);}{
  constructs an analysis for the curve defined by p. The polynomial must
  be squarefree. The iterator range [begin,end) contains factors of 
  $\mbox{resultant}(p,p_y,y)$ 
  i.e., their roots define $x$-coordinates of events, 
  which allows to simplify the real root isolation within this layer.
  The \ccc{value_type} of InputIterator is \ccc{Polynomial_1}. 
  This constructor has been introduced to enable an upper layer (CK) to 
  propagate additional knowledge on the problem.
}
\end{ccAdvanced}

\ccAccessFunctions

\ccMethod{Polynomial_2 get_polynomial_2();}{
  returns the defining polynomial of the analysis
}

\ccMethod{unsigned int number_of_vertical_lines_with_event();}{
  returns number of vertical lines that encode an event
}

\ccMethod{Curve_vertical_line_1 vertical_line_at_event(int i);}{
  returns an instance of \ccc{CurveVerticalLine_1} at the $i$-th event
}

\ccMethod{Curve_vertical_line_1 vertical_line_of_interval(int i);}{
  returns an instance of \ccc{CurveVerticalLine_1} of the $i$-th interval
  between $x$-events.
}

\ccMethod{Curve_vertical_line_1 vertical_line_for_x(Algebraic_real_1 x, 
  CGAL::Sign perturb = CGAL::ZERO);}{
 returns vertical\_line\_at\_event(i), if $x$ hits $i$-th event, otherwise
 returns vertical\_line\_of\_interval(i), where $i$ is the id of the interval
  $x$ lies in. If $pertub$ is CGAL::NEGATIVE (CGAL::POSITIVE) and $x$ states
  an event, then vertical\_line\_of\_interval(i) 
  (vertical\_line\_of\_interval(i+1)) is returned.
  \ccPrecond{$x$ is finite}
}

\ccMethod{Curve_vertical_line_1 vertical_line_at_exact_x(Algebraic_real_1 x);}{
  returns an instance of \ccc{CurveVerticalLine_1} at the given $x$.
  \ccPrecond{$x$ is finite}
}

Note that the access methods to vertical lines are not redundant! The ones
using an id-value are efficient for speed-ups (caching, avoids to search for
some $x$, or the unique representative vertical line for an interval). 
The others enable a user to compute vertical lines for given $x$, 
i.e., also to access $y$-coordinates at given $x$.

%\begin{ccAdvanced}
%
%\ccMethod{int find(Algebraic_real_2 s);}{
%  returns the index of the event at the vertical line defined by 
%  $s$'s $x$-coordinate, or -1 if $s$ is does not lie on the curve.
%}
%
%\end{ccAdvanced}


\end{ccRefConcept}
