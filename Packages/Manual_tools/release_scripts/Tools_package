#!/bin/sh

if [ $# -ne 2 ]; then
  echo "Usage $0 <source directory> <target directory>"
  exit 1
else 
  if [ $1 = "." ]; then
     SOURCE_DIR=`pwd`
  else
     SOURCE_DIR=$1
  fi
  if [ $2 = "." ]; then
     TARGET_DIR=`pwd`
  else
     TARGET_DIR=$2
  fi
fi

if [ ! -d $SOURCE_DIR ]; then
  echo "Source directory $SOURCE_DIR does not exist"
  exit 1
fi

if [ $SOURCE_DIR = $TARGET_DIR ]; then
  echo "Source and target directories are the same!"
  exit 1
fi

CURR_DIR=`pwd`

echo "source" $SOURCE_DIR
echo "target" $TARGET_DIR
echo "current" $CURR_DIR



mkdir -p $TARGET_DIR/Tools/doc

cp $SOURCE_DIR/INSTALLATION $TARGET_DIR/Tools
cp $SOURCE_DIR/README $TARGET_DIR/Tools
cp $SOURCE_DIR/CHANGES $TARGET_DIR/Tools

cd $SOURCE_DIR/doc 
echo
echo "Now in doc directory"
echo
   make_manual
   cd $CURR_DIR
   cp $SOURCE_DIR/doc/*.tex  $TARGET_DIR/Tools/doc
   cp $SOURCE_DIR/doc/*.ps.gz  $TARGET_DIR/Tools/doc
   cp $SOURCE_DIR/doc/README $TARGET_DIR/Tools/doc
   cp $SOURCE_DIR/doc/*.ips $TARGET_DIR/Tools/doc
   cp $SOURCE_DIR/doc/manual.bib $TARGET_DIR/Tools/doc

cd $CURR_DIR
mkdir -p $TARGET_DIR/Tools/format

cd $SOURCE_DIR/format
echo
echo "Now in format directory"
echo
   cd $CURR_DIR
   cp $SOURCE_DIR/format/*.sty $TARGET_DIR/Tools/format
   cp -r $SOURCE_DIR/format/eps_tabs $TARGET_DIR/Tools/format
   cp $SOURCE_DIR/format/index_test.tex $TARGET_DIR/Tools/format
   cp $SOURCE_DIR/format/test.tex $TARGET_DIR/Tools/format
   cp $SOURCE_DIR/format/README $TARGET_DIR/Tools/format


cd $CURR_DIR
mkdir -p $TARGET_DIR/Tools/scripts

cd $SOURCE_DIR/scripts
echo
echo "Now in scripts directory"
echo
   cd $CURR_DIR
   cp $SOURCE_DIR/scripts/add_part_num $TARGET_DIR/Tools/scripts
   cp $SOURCE_DIR/scripts/cc_make_ref_pages $TARGET_DIR/Tools/scripts
   cp $SOURCE_DIR/scripts/cc_ref_wizard $TARGET_DIR/Tools/scripts
   cp $SOURCE_DIR/scripts/cc_ref_wizard_rc $TARGET_DIR/Tools/scripts
   cp $SOURCE_DIR/scripts/index_fix $TARGET_DIR/Tools/scripts
   cp $SOURCE_DIR/scripts/README $TARGET_DIR/Tools/scripts


cd $CURR_DIR
mkdir -p $TARGET_DIR/Tools/src/latex_converter_config
mkdir -p $TARGET_DIR/Tools/src/test
mkdir -p $TARGET_DIR/Tools/src/test_html

cd $SOURCE_DIR/src
echo 
echo "Now in src directory"
echo
   cd $CURR_DIR
   cp -r $SOURCE_DIR/src/* $TARGET_DIR/Tools/src
   \rm -f -r $TARGET_DIR/Tools/src/RCS
   \rm -f -r $TARGET_DIR/Tools/src/latex_converter_config/html/RCS
   \rm -f -r $TARGET_DIR/Tools/src/latex_converter_config/ref_pages/RCS

cd $CURR_DIR
mkdir -p $TARGET_DIR/Tools/example

cd $SOURCE_DIR/example
echo 
echo "Now in example directory"
echo
   cd one_manual
   make
   make clean
   cd ..
   cd two_manuals
   make
   make clean
   cd ..
   cd one_manual_ext_html
   make
   make clean
   cd ..
   cd two_manuals_ext_html
   make
   make clean
   cd ..
   cd $CURR_DIR
   cp -R $SOURCE_DIR/example/* $TARGET_DIR/Tools/example
