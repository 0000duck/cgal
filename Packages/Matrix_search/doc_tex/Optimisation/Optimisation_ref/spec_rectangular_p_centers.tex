%% ==============================================================
%% Specification: Rectangular p-Centers
%% --------------------------------------------------------------
%% file  : spec_rectangular_p_centers.awi
%% author: Michael Hoffmann
%% $Id$
%% ==============================================================

\cgalColumnLayout

\begin{ccRefFunction}{rectangular_p_center_2}
  \ccIndexMainItem[t]{rectilinear centers}
  \ccIndexMainItem[t]{rectangular centers}
  \ccIndexSubitem[t]{center}{rectangular}
  
  \ccDefinition The function \ccRefName\ computes rectilinear
  $p$-centers of a planar point set, i.e. a set of $p$ points such
  that the maximum minimal $L_{\infty}$-distance between both sets is
  minimized.
  
  More formally the problem can be defined as follows.
  
  \ccTexHtml{Given a finite set $\mathcal{P}$ of points, compute a
    point set $\mathcal{C}$ with $|\mathcal{C}| \le p$ such that the
    $p$-radius of $\mathcal{P}$,
    $$
    rad_p(\mathcal{P}) := \max_{P \in \mathcal{P}} \min_{Q \in
      \mathcal{C}} || P - Q ||_\infty
    $$
    is minimized. We can interpret $\mathcal{C}$ as the best
    approximation (with respect to the given metric) for $\mathcal{P}$
    with at most $p$ points.}{Given a finite set <IMG WIDTH=12
    HEIGHT=12 ALIGN=BOTTOM ALT="tex2html_wrap_inline17"
    SRC="./MatrixSearch_pcenter1.gif" > of points, compute a point set
    <IMG WIDTH=9 HEIGHT=13 ALIGN=BOTTOM ALT="tex2html_wrap_inline19"
    SRC="./MatrixSearch_pcenter2.gif" > with <IMG WIDTH=46 HEIGHT=24
    ALIGN=MIDDLE ALT="tex2html_wrap_inline21"
    SRC="./MatrixSearch_pcenter3.gif" > such that the <I>p</I>-radius
    of <IMG WIDTH=12 HEIGHT=12 ALIGN=BOTTOM
    ALT="tex2html_wrap_inline17" SRC="./MatrixSearch_pcenter1.gif" > ,
    <P> <IMG WIDTH=358 HEIGHT=24 ALIGN=BOTTOM ALT="displaymath27"
    SRC="./MatrixSearch_pcenter4.gif" > <P> is minimized. We can
    interpret <IMG WIDTH=9 HEIGHT=13 ALIGN=BOTTOM
    ALT="tex2html_wrap_inline19" SRC="./MatrixSearch_pcenter2.gif" >
    as the best approximation (with respect to the given metric) for
    <IMG WIDTH=12 HEIGHT=12 ALIGN=BOTTOM ALT="tex2html_wrap_inline17"
    SRC="./MatrixSearch_pcenter1.gif" > with at most <I>p</I> points.}

  \ccInclude{CGAL/rectangular_p_center_2.h}

  \def\ccLongParamLayout{\ccTrue} 
  
  \ccGlobalFunction{template < class ForwardIterator, class
    OutputIterator, class FT, class Traits > OutputIterator
    rectangular_p_center_2(ForwardIterator f, ForwardIterator l,
    OutputIterator o, FT& r, int p, const Traits& t =
    Default_traits);}
  
  computes rectilinear \ccc{p}-centers for the point set described by
  the range [\ccc{f}, \ccc{l}), sets \ccc{r} to the corresponding
  $p$-radius, writes the at most \ccc{p} center points to \ccc{o} and
  returns the past-the-end iterator of this sequence.
  
  \ccPrecond
  \begin{enumerate}
  \item The range [\ccc{f}, \ccc{l}) is not empty.
  \item 2 $\le$ \ccc{p} $\le$ 4.
  \end{enumerate}
  
  The geometric types and operations to be used for the computation
  are specified by the traits class parameter \ccc{t}. This parameter
  can be omitted if \ccc{ForwardIterator} refers to a point type from
  the 2D-Kernel. In this case, a default traits class
  (\ccc{Rectangular_p_center_default_traits_2<R>}) is used.
  
  \ccRequire
  \begin{enumerate}
  \item \textit{Either: (if no traits parameter is given)} Value type
    of \ccc{ForwardIterator} is \ccc{CGAL::Point_2<R>} for some
    representation class \ccc{R} and \ccc{FT} is equivalent to
    \ccc{R::FT},
  \item \textit{Or: (if a traits parameter is specified)} \ccc{Traits}
    is a model for \ccc{RectangularPCenterTraits_2}.
  \item \ccc{OutputIterator} accepts the value type of
    \ccc{ForwardIterator} as value type.
  \end{enumerate}  
  
  \ccSeeAlso
  \ccRefConceptPage{RectangularPCenterTraits_2}\\
  \ccRefIdfierPage{CGAL::Rectangular_p_center_default_traits_2<R>}\\
  \ccRefIdfierPage{CGAL::sorted_matrix_search}
  
  \ccImplementation The runtime is linear for $p \in \{2,\,3\}$ and
  $\mathcal{O}(n \cdot \log n)$ for $p = 4$ where $n$ is the number of
  input points. These runtimes are worst case optimal. The $3$-center
  algorithm uses a prune-and-search technique described in
  \cite{h-slacr-99}.  The $4$-center implementation uses sorted matrix
  search \cite{fj-fkppc-83,fj-gsrsm-84} and fast algorithms for
  piercing rectangles \cite{sw-rpppp-96}.
  
  \ccExample The following code generates a random set of ten points
  and computes its two-centers.

  \ccIncludeVerbatim{Optimisation_ref/rectangular_p_center_2_example_noheader.C}
\end{ccRefFunction}

\begin{ccRefClass}{Rectangular_p_center_default_traits_2<R>}
  \ccCreationVariable{t}\ccTagFullDeclarations
    
  \ccDefinition The class \ccRefName\ defines types and operations
  needed to compute rectilinear $p$-centers of a planar point set
  using the function \ccc{rectangular_p_center_2}.
  
  \ccRequirements The template parameter \ccc{R} is a model for
  \ccc{Kernel}.
  
  \ccIsModel
  \ccRefConceptPage{RectangularPCenterTraits_2}

  \ccTypes 
    
  \ccNestedType{FT}{typedef to \ccc{R::FT}.}
  
  \ccNestedType{Point_2}{typedef to \ccc{R::Point_2}.}
  
  \ccNestedType{Iso_rectangle_2}{typedef to \ccc{R::Iso_rectangle_2}.}
  
  \ccNestedType{Less_x_2}{adaptable binary function class:
    \ccc{Point_2} $\times$ \ccc{Point_2} $\rightarrow$ \ccc{bool}
    returns true, iff the first point has smaller x-coordinate than
    the second.}
  
  \ccNestedType{Less_y_2}{adaptable binary function class:
    \ccc{Point_2} $\times$ \ccc{Point_2} $\rightarrow$ \ccc{bool}
    returns true, iff the first point has smaller y-coordinate than
    the second.}
  
  \ccNestedType{Greater_x_2}{adaptable binary function class:
    \ccc{Point_2} $\times$ \ccc{Point_2} $\rightarrow$ \ccc{bool}
    returns true, iff the first point has greater x-coordinate than
    the second.}
  
  \ccNestedType{Greater_y_2}{adaptable binary function class:
    \ccc{Point_2} $\times$ \ccc{Point_2} $\rightarrow$ \ccc{bool}
    returns true, iff the first point has greater y-coordinate than
    the second.}
  
  \ccNestedType{Signed_x_distance_2}{adaptable binary function
    class: \ccc{Point_2} $\times$ \ccc{Point_2} $\rightarrow$
    \ccc{FT} returns the signed distance of two points'
    $x$-coordinates.}
  
  \ccNestedType{Signed_y_distance_2}{adaptable binary function
    class: \ccc{Point_2} $\times$ \ccc{Point_2} $\rightarrow$
    \ccc{FT} returns the signed distance of two points'
    $y$-coordinates.}
  
  \ccNestedType{Infinity_distance_2}{adaptable binary function
    class: \ccc{Point_2} $\times$ \ccc{Point_2} $\rightarrow$
    \ccc{FT} returns the $||\cdot||_{\infty}$ distance of two
    points.}
  
  \ccNestedType{Signed_infinity_distance_2}{adaptable binary
    function class: \ccc{Point_2} $\times$ \ccc{Point_2}
    $\rightarrow$ \ccc{FT} returns the signed $||\cdot||_{\infty}$
    distance of two points.}
  
  \ccNestedType{Construct_min_point_2}{adaptable unary function
    class: \ccc{Iso_rectangle_2} $\rightarrow$ \ccc{Point_2} returns
    the lower-left corner of a rectangle.}
  
  \ccNestedType{Construct_max_point_2}{adaptable unary function class:
    \ccc{Iso_rectangle_2} $\rightarrow$ \ccc{Point_2} returns the
    upper-right corner of a rectangle.}
  
  \ccNestedType{Construct_corner_2}{adaptable binary function class:
    \ccc{Iso_rectangle_2} $\times$ \ccc{unsigned int} $\rightarrow$
    \ccc{Point_2} returns the i-th (starting from lower-left and then
    counterclockwise) corner of a rectangle.}
  
  \ccNestedType{Construct_projection_onto_horizontal_implicit_line_2}{
    adaptable binary function class: \ccc{Point_2} $\times$
    \ccc{Point_2} $\rightarrow$ \ccc{Point_2} returns the
    (orthogonal) projection of the first point onto the horizontal
    line through the second point.}
  
  \ccNestedType{Construct_iso_rectangle_2}{4-argument function class:
    \ccc{Point_2} $\times$ \ccc{Point_2} $\times$ \ccc{Point_2}
    $\times$ \ccc{Point_2} $\rightarrow$ \ccc{Iso_rectangle_2} returns
    the rectangle with point $i$ on the left, bottom, right, top resp.
    side.}
    
  \ccNestedType{Construct_point_2_below_left_implicit_point_2}{
    3-argument function class: \ccc{Point_2} $\times$ \ccc{Point_2}
    $\times$ \ccc{FT} $\rightarrow$ \ccc{Point_2}. For arguments
    $(p,\,q,\,r)$ it returns the lower-left corner of the iso-oriented
    square with sidelength $r$ and upper-right corner at the
    intersection of the vertical line through $p$ and the horizontal
    line through $q$.}
    
  \ccNestedType{Construct_point_2_below_right_implicit_point_2}{
    3-argument function class: \ccc{Point_2} $\times$ \ccc{Point_2}
    $\times$ \ccc{FT} $\rightarrow$ \ccc{Point_2}. For arguments
    $(p,\,q,\,r)$ it returns the lower-right corner of the
    iso-oriented square with sidelength $r$ and upper-left corner at
    the intersection of the vertical line through $p$ and the
    horizontal line through $q$.}
    
  \ccNestedType{Construct_point_2_above_right_implicit_point_2}{
    3-argument function class: \ccc{Point_2} $\times$ \ccc{Point_2}
    $\times$ \ccc{FT} $\rightarrow$ \ccc{Point_2}. For arguments
    $(p,\,q,\,r)$ it returns the upper-right corner of the
    iso-oriented square with sidelength $r$ and lower-left corner at
    the intersection of the vertical line through $p$ and the
    horizontal line through $q$.}
    
  \ccNestedType{Construct_point_2_above_left_implicit_point_2}{
    3-argument function class: \ccc{Point_2} $\times$ \ccc{Point_2}
    $\times$ \ccc{FT} $\rightarrow$ \ccc{Point_2}. For arguments
    $(p,\,q,\,r)$ it returns the upper-left corner of the iso-oriented
    square with sidelength $r$ and lower-right corner at the
    intersection of the vertical line through $p$ and the horizontal
    line through $q$.}

  \ccHeading{These can be derived from \ccc{Less} and \ccc{Greater}:}
  
  \ccNestedType{Min_x_2}{adaptable binary function class:
    \ccc{Point_2} $\times$ \ccc{Point_2} $\rightarrow$ \ccc{Point_2}
    returns the point with smaller x-coordinate.}
  
  \ccNestedType{Max_x_2}{adaptable binary function class:
    \ccc{Point_2} $\times$ \ccc{Point_2} $\rightarrow$ \ccc{Point_2}
    returns the point with greater x-coordinate.}
  
  \ccNestedType{Min_y_2}{adaptable binary function class:
    \ccc{Point_2} $\times$ \ccc{Point_2} $\rightarrow$ \ccc{Point_2}
    returns the point with smaller y-coordinate.}
  
  \ccNestedType{Max_y_2}{adaptable binary function class:
    \ccc{Point_2} $\times$ \ccc{Point_2} $\rightarrow$ \ccc{Point_2}
    returns the point with greater y-coordinate.}

  \ccOperations
  
  For every function class listed above there is a member function
  to fetch the corresponding function object.
  
  \ccMemberFunction{Inf_distance_2 inf_distance_2_object() const;}{}
  \ccGlue\ccMemberFunction{Signed_inf_distance_2
    signed_inf_distance_2_object() const;}{}
  
  \ccGlue\ccMemberFunction{Construct_min_point_2
    construct_min_point_2_object() const;}{}
  
  \ccGlue\ccMemberFunction{Construct_max_point_2
    construct_max_point_2_object() const;}{}
  
  \ccGlue\ccMemberFunction{Construct_corner_2 construct_corner_2_object()
    const;}{}
  
  \ccGlue\ccMemberFunction{Construct_iso_rectangle_2
    construct_iso_rectangle_2_object() const;}{}
  
  \ccGlue\ccMemberFunction{Construct_projection_onto_horizontal_implicit_line_2
    construct_projection_onto_horizontal_implicit_line_2_object()
    const;}{}
  
  \ccGlue\ccMemberFunction{Construct_iso_rectangle_2_below_left_point_2
    construct_iso_rectangle_2_below_left_point_2_object() const;}{}
  
  \ccGlue\ccMemberFunction{Construct_iso_rectangle_2_above_left_point_2
    construct_iso_rectangle_2_above_left_point_2_object() const;}{}
  
  \ccGlue\ccMemberFunction{Construct_iso_rectangle_2_below_right_point_2
    construct_iso_rectangle_2_below_right_point_2_object() const;}{}
  
  \ccGlue\ccMemberFunction{Construct_iso_rectangle_2_above_right_point_2
    construct_iso_rectangle_2_above_right_point_2_object() const;}{}
  
  \ccGlue\ccMemberFunction{Min_x_2 min_x_2_object() const;}{}
  
  \ccGlue\ccMemberFunction{Max_x_2 max_x_2_object() const;}{}
  
  \ccGlue\ccMemberFunction{Min_y_2 min_y_2_object() const;}{}
  
  \ccGlue\ccMemberFunction{Max_y_2 max_y_2_object() const;}{}
  
  \ccSeeAlso
  \ccRefIdfierPage{CGAL::rectangular_p_center_2}

\end{ccRefClass}

\begin{ccRefConcept}{RectangularPCenterTraits_2}
  \ccCreationVariable{t}\ccTagFullDeclarations
    
  \ccDefinition The concept \ccRefName\ defines types and operations
  needed to compute rectilinear $p$-centers of a planar point set
  using the function \ccc{rectangular_p_center_2}.
  
  \ccTypes 
    
  \ccNestedType{FT}{class used for doing computations on point
    coordinates; it has to be a model for \ccc{FieldNumberType}.}
  
  \ccNestedType{Point_2}{class used for representing the input
    points.}
  
  \ccNestedType{Iso_rectangle_2}{class used for representing
    axis-parallel rectangles.}
  
  \ccNestedType{Less_x_2}{adaptable binary function class:
    \ccc{Point_2} $\times$ \ccc{Point_2} $\rightarrow$ \ccc{bool}
    returns true, iff the first point has smaller x-coordinate than
    the second.}
  
  \ccNestedType{Less_y_2}{adaptable binary function class:
    \ccc{Point_2} $\times$ \ccc{Point_2} $\rightarrow$ \ccc{bool}
    returns true, iff the first point has smaller y-coordinate than
    the second.}
  
  \ccNestedType{Greater_x_2}{adaptable binary function class:
    \ccc{Point_2} $\times$ \ccc{Point_2} $\rightarrow$ \ccc{bool}
    returns true, iff the first point has greater x-coordinate than
    the second.}
  
  \ccNestedType{Greater_y_2}{adaptable binary function class:
    \ccc{Point_2} $\times$ \ccc{Point_2} $\rightarrow$ \ccc{bool}
    returns true, iff the first point has greater y-coordinate than
    the second.}
  
  \ccNestedType{Signed_x_distance_2}{adaptable binary function
    class: \ccc{Point_2} $\times$ \ccc{Point_2} $\rightarrow$
    \ccc{FT} returns the signed distance of two points'
    $x$-coordinates.}
  
  \ccNestedType{Signed_y_distance_2}{adaptable binary function
    class: \ccc{Point_2} $\times$ \ccc{Point_2} $\rightarrow$
    \ccc{FT} returns the signed distance of two points'
    $y$-coordinates.}
  
  \ccNestedType{Infinity_distance_2}{adaptable binary function
    class: \ccc{Point_2} $\times$ \ccc{Point_2} $\rightarrow$
    \ccc{FT} returns the $||\cdot||_{\infty}$ distance of two
    points.}
  
  \ccNestedType{Signed_infinity_distance_2}{adaptable binary
    function class: \ccc{Point_2} $\times$ \ccc{Point_2}
    $\rightarrow$ \ccc{FT} returns the signed $||\cdot||_{\infty}$
    distance of two points.}
  
  \ccNestedType{Construct_min_point_2}{adaptable unary function
    class: \ccc{Iso_rectangle_2} $\rightarrow$ \ccc{Point_2} returns
    the lower-left corner of a rectangle.}
  
  \ccNestedType{Construct_max_point_2}{adaptable unary function class:
    \ccc{Iso_rectangle_2} $\rightarrow$ \ccc{Point_2} returns the
    upper-right corner of a rectangle.}
  
  \ccNestedType{Construct_corner_2}{adaptable binary function class:
    \ccc{Iso_rectangle_2} $\times$ \ccc{unsigned int} $\rightarrow$
    \ccc{Point_2} returns the i-th (starting from lower-left and then
    counterclockwise) corner of a rectangle.}
  
  \ccNestedType{Construct_projection_onto_horizontal_implicit_line_2}{
    adaptable binary function class: \ccc{Point_2} $\times$
    \ccc{Point_2} $\rightarrow$ \ccc{Point_2} returns the
    (orthogonal) projection of the first point onto the horizontal
    line through the second point.}
  
  \ccNestedType{Construct_iso_rectangle_2}{4-argument function class:
    \ccc{Point_2} $\times$ \ccc{Point_2} $\times$ \ccc{Point_2}
    $\times$ \ccc{Point_2} $\rightarrow$ \ccc{Iso_rectangle_2} returns
    the rectangle with point $i$ on the left, bottom, right, top resp.
    side.}
    
  \ccNestedType{Construct_point_2_below_left_implicit_point_2}{
    3-argument function class: \ccc{Point_2} $\times$ \ccc{Point_2}
    $\times$ \ccc{FT} $\rightarrow$ \ccc{Point_2}. For arguments
    $(p,\,q,\,r)$ it returns the lower-left corner of the iso-oriented
    square with sidelength $r$ and upper-right corner at the
    intersection of the vertical line through $p$ and the horizontal
    line through $q$.}
    
  \ccNestedType{Construct_point_2_below_right_implicit_point_2}{
    3-argument function class: \ccc{Point_2} $\times$ \ccc{Point_2}
    $\times$ \ccc{FT} $\rightarrow$ \ccc{Point_2}. For arguments
    $(p,\,q,\,r)$ it returns the lower-right corner of the
    iso-oriented square with sidelength $r$ and upper-left corner at
    the intersection of the vertical line through $p$ and the
    horizontal line through $q$.}
    
  \ccNestedType{Construct_point_2_above_right_implicit_point_2}{
    3-argument function class: \ccc{Point_2} $\times$ \ccc{Point_2}
    $\times$ \ccc{FT} $\rightarrow$ \ccc{Point_2}. For arguments
    $(p,\,q,\,r)$ it returns the upper-right corner of the
    iso-oriented square with sidelength $r$ and lower-left corner at
    the intersection of the vertical line through $p$ and the
    horizontal line through $q$.}
    
  \ccNestedType{Construct_point_2_above_left_implicit_point_2}{
    3-argument function class: \ccc{Point_2} $\times$ \ccc{Point_2}
    $\times$ \ccc{FT} $\rightarrow$ \ccc{Point_2}. For arguments
    $(p,\,q,\,r)$ it returns the upper-left corner of the iso-oriented
    square with sidelength $r$ and lower-right corner at the
    intersection of the vertical line through $p$ and the horizontal
    line through $q$.}

  \ccHeading{These can be derived from \ccc{Less} and \ccc{Greater}:}
  
  \ccNestedType{Min_x_2}{adaptable binary function class:
    \ccc{Point_2} $\times$ \ccc{Point_2} $\rightarrow$ \ccc{Point_2}
    returns the point with smaller x-coordinate.}
  
  \ccNestedType{Max_x_2}{adaptable binary function class:
    \ccc{Point_2} $\times$ \ccc{Point_2} $\rightarrow$ \ccc{Point_2}
    returns the point with greater x-coordinate.}
  
  \ccNestedType{Min_y_2}{adaptable binary function class:
    \ccc{Point_2} $\times$ \ccc{Point_2} $\rightarrow$ \ccc{Point_2}
    returns the point with smaller y-coordinate.}
  
  \ccNestedType{Max_y_2}{adaptable binary function class:
    \ccc{Point_2} $\times$ \ccc{Point_2} $\rightarrow$ \ccc{Point_2}
    returns the point with greater y-coordinate.}

  \ccOperations
  
  For every function class listed above there is a member function
  to fetch the corresponding function object.
  
  \ccMemberFunction{Inf_distance_2 inf_distance_2_object() const;}{}
  \ccGlue\ccMemberFunction{Signed_inf_distance_2
    signed_inf_distance_2_object() const;}{}
  
  \ccGlue\ccMemberFunction{Construct_min_point_2
    construct_min_point_2_object() const;}{}
  
  \ccGlue\ccMemberFunction{Construct_max_point_2
    construct_max_point_2_object() const;}{}
  
  \ccGlue\ccMemberFunction{Construct_corner_2 construct_corner_2_object()
    const;}{}
  
  \ccGlue\ccMemberFunction{Construct_iso_rectangle_2
    construct_iso_rectangle_2_object() const;}{}
  
  \ccGlue\ccMemberFunction{Construct_projection_onto_horizontal_implicit_line_2
    construct_projection_onto_horizontal_implicit_line_2_object()
    const;}{}
  
  \ccGlue\ccMemberFunction{Construct_iso_rectangle_2_below_left_point_2
    construct_iso_rectangle_2_below_left_point_2_object() const;}{}
  
  \ccGlue\ccMemberFunction{Construct_iso_rectangle_2_above_left_point_2
    construct_iso_rectangle_2_above_left_point_2_object() const;}{}
  
  \ccGlue\ccMemberFunction{Construct_iso_rectangle_2_below_right_point_2
    construct_iso_rectangle_2_below_right_point_2_object() const;}{}
  
  \ccGlue\ccMemberFunction{Construct_iso_rectangle_2_above_right_point_2
    construct_iso_rectangle_2_above_right_point_2_object() const;}{}
  
  \ccGlue\ccMemberFunction{Min_x_2 min_x_2_object() const;}{}
  
  \ccGlue\ccMemberFunction{Max_x_2 max_x_2_object() const;}{}
  
  \ccGlue\ccMemberFunction{Min_y_2 min_y_2_object() const;}{}
  
  \ccGlue\ccMemberFunction{Max_y_2 max_y_2_object() const;}{}
  
  \ccHasModels
  \ccRefIdfierPage{CGAL::Rectangular_p_center_default_traits_2<R>}

  \ccSeeAlso
  \ccRefIdfierPage{CGAL::rectangular_p_center_2}

\end{ccRefConcept}

%% --------------------------------------------------------------
%% EOF spec_rectangular_p_centers.awi
%% --------------------------------------------------------------
