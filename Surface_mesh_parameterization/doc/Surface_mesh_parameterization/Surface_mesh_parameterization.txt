namespace CGAL {
/*!

\mainpage User Manual 
\anchor Chapter_Planar_Parameterization_of_Triangulated_Surface_Meshes

\anchor chapsurface_mesh_parameterization
\cgalAutoToc

\authors Laurent Saboret, Pierre Alliez, Bruno L&eacute;vy, and Andreas Fabri

\section Surface_mesh_parameterizationIntroduction Introduction

Parameterizing a surface amounts to finding a one-to-one mapping from
a suitable domain to the surface. A good mapping is the one which
minimizes either angle distortions (conformal parameterization) or
area distortions (equiareal parameterization) in some sense. In this
package, we focus on parameterizing triangulated surfaces which are
homeomorphic to a disk, and on piecewise linear mappings onto a planar
domain.

Although the main motivation behind the first parameterization methods
was the application to texture mapping, it is now frequently used for
mapping more sophisticated modulation signals (such as normal,
transparency, reflection or light modulation maps), fitting scattered
data, re-parameterizing spline surfaces, repairing CAD models,
approximating surfaces and remeshing.

This \cgal package implements 
surface parameterization methods, such as least squares conformal maps,
discrete conformal map, discrete authalic
parameterization, Floater mean value coordinates or Tutte barycentric
mapping. These methods mainly distinguish by the distortion they
minimize (angles vs. areas), by the constrained border onto the
planar domain (convex polygon vs. free border) and by the guarantees
provided in terms of bijective mapping.

The package proposes an interface for any model of the concept `FaceGraph`,
that is classes as  `Polyhedron_3`, `Surface_mesh`, as well as mesh
classes of OpenMesh.


Since parameterizing meshes require efficient representation of sparse
matrices and efficient iterative or direct linear solvers, we provide
a unified interface to linear solvers  as described in Chapter 
\ref PkgSolverSummary.

Note that linear solvers commonly use double precision floating point
numbers. Therefore, this package is intended to be used with a \cgal %Cartesian kernel with doubles.


\cgalFigureBegin{Surface_mesh_parameterizationfigintroduction,introduction.jpg}
Texture mapping via Least Squares Conformal Maps parameterization. Top: original mesh and texture. Bottom: parameterizedmesh (left: parameter space, right: textured mesh).
\cgalFigureEnd

\section Surface_mesh_parameterizationBasics Basics

\subsection Surface_mesh_parameterizationDefaultSurface Default Surface Parameterization

From the user point of view, the simplest entry point to this package
is the following function:

\code{.cpp}
template <typename TriangleMesh>
Parameterizer_traits<TriangleMesh>::Error_code
parameterize(TriangleMesh & mesh,
             boost::graph_traits<TriangleMesh>::halfedge_descriptor bhd,
             VertexUvMap uvm);
\endcode

The function `parameterize()` applies a default surface parameterization
method, namely Floater Mean Value Coordinates \cgalCite{cgal:f-mvc-03}, 
to the connected component of the mesh of type `TriangleMesh` with the border given by the halfedge `bhd`.
This border is parameterized with an arc-length circular border parameterization. 
The sparse linear solver used is from the \ref thirdpartyEigen library. 

The mesh of type `TriangleMesh` which must be a model of the concept
`FaceGraph`, additionally must be triangulated, 2-manifold, oriented,
and homeomorphic to a disc (possibly with holes). We will later show
hpw to parameterize a mesh that is not a topological disk.

The result is stored in a property map for the mesh vertices.


`Parameterizer_traits_3<TriangleMesh>` is a base class of all surface
parameterizations and defines the error codes.


In the following example, we apply the default parameterization to a
`Polyhedron_3` mesh, and we use a ` Unique_hash_map` to store the uv-coordinates
of each vertex.

\cgalExample{Surface_mesh_parameterization/Simple_parameterization.cpp}


\subsection Surface_mesh_parameterizationEnhancedparameterize Choosing a Parameterization Algorithm

This package provides a second `parameterize()` entry point
where the user can specify a parameterization method:

\code{.cpp}
template <typename TriangleMesh>
Parameterizer_traits<TriangleMesh>::Error_code
parameterize(TriangleMesh& mesh,
             ParameterizerTraits_3 parameterizer,
             boost::graph_traits<TriangleMesh>::halfedge_descriptor bhd,
             VertexUvMap uvm);
\endcode



In the following example, we apply the circular borde parameterizations
and then the discrete authalic parameterization to a
`Surface_mesh`. We store the uv-coordinates as a vertex property
using the built-in property mechanism.

\cgalExample{Surface_mesh_parameterization/discrete_authalic.cpp}





\section secSurfaceParameterizationMethods Surface Parameterization Methods 

This \cgal package implements surface parameterization methods, such
as Least Squares Conformal Maps, Discrete Conformal Map, Discrete
Authalic Parameterization, Floater Mean Value Coordinates or Tutte
Barycentric Mapping. These methods are provided as models of the
`ParameterizerTraits_3` concept.

\subsection Surface_mesh_parameterizationFixedBorder Fixed Border Surface Parameterizations

Fixed border surface parameterizations need a set of constraints: two
(u,v) coordinates for each vertex along the border.
Such border parameterizations are described in Section
\ref secBorderParameterizationsforFixedMethods.

\subsubsection Surface_mesh_parameterizationTutteBarycentric Tutte Barycentric Mapping

`Barycentric_mapping_parameterizer_3<TriangleMesh, BorderParameterizer_3, SparseLinearAlgebraTraits_d>` 

The Barycentric Mapping parameterization method has been introduced by
Tutte \cgalCite{t-hdg-63}. In parameter space, each vertex is
placed at the barycenter of its neighbors to achieve the so-called
convex combination condition. This algorithm amounts to solve one
sparse linear solver for each set of parameter coordinates, with a
\#vertices x \#vertices sparse and symmetric positive definite matrix
(if the border vertices are eliminated from the linear system).
A coefficient \f$ (i, j)\f$ of the matrix is set to 1 for an edge linking
the vertex \f$ v_i\f$ to the vertex \f$ v_j\f$, to minus the degree of the
vertex \f$ v_i\f$ for a diagonal element, and to 0 for any other matrix
entry. Although a bijective mapping is guaranteed when the border is convex,
this method does not minimize angles nor areas distortion.

\cgalFigureBegin{Surface_mesh_parameterizationfiguniform,uniform.png}
Left: Tutte barycentric mapping parameterization (the red line depicts the cut graph). Right: parameter space.
\cgalFigureEnd

\subsubsection Surface_mesh_parameterizationDiscreteConformal Discrete Conformal Map

`Discrete_conformal_map_parameterizer_3<TriangleMesh, BorderParameterizer_3, SparseLinearAlgebraTraits_d>` 

Discrete conformal map parameterization has been introduced by Eck et
al. to the graphics community \cgalCite{cgal:eddhls-maam-95}. It attempts to
lower angle deformation by minimizing a discrete version of the
Dirichlet energy as derived by Pinkall and
Polthier \cgalCite{cgal:pp-cdmsc-93}. A one-to-one mapping is guaranteed
only when the two following conditions are fulfilled: the barycentric mapping
condition (each vertex in parameter space is a convex combination if
its neighboring vertices), and the border is convex.
This method solves two \#vertices x \#vertices sparse linear
systems. The matrix (the same for both systems) is sparse and symmetric definite
positive (if the border vertices are eliminated from the linear system
and if the mesh contains no hole),
thus can be efficiently solved using dedicated linear solvers.

\cgalFigureBegin{Surface_mesh_parameterizationfigconformal,conformal.png}
Left: discrete conformal map. Right: parameter space.
\cgalFigureEnd

\subsubsection Surface_mesh_parameterizationFloaterMean Floater Mean Value Coordinates

`Mean_value_coordinates_parameterizer_3<TriangleMesh, BorderParameterizer_3, SparseLinearAlgebraTraits_d>` 

The mean value coordinates parameterization method has been introduced
by Floater \cgalCite{cgal:f-mvc-03}. Each vertex in parameter space is
optimized so as to be a convex combination of its neighboring
vertices. The barycentric coordinates are this time unconditionally
positive, by deriving an application of the mean theorem for harmonic
functions. This method is in essence an approximation of the discrete conformal
maps, with a guaranteed one-to-one mapping when the border is convex.
This method solves two \#vertices x \#vertices sparse linear systems. The matrix (the
same for both systems) is asymmetric.

\cgalFigureBegin{Surface_mesh_parameterizationfigfloater,floater.png}
Floater Mean Value Coordinates
\cgalFigureEnd

\subsubsection Surface_mesh_parameterizationDiscreteAuthalic Discrete Authalic Parameterization

`Discrete_authalic_parameterizer_3<TriangleMesh, BorderParameterizer_3, SparseLinearAlgebraTraits_d>` 

The discrete authalic parameterization method has been introduced by
Desbrun et al. \cgalCite{cgal:dma-ipsm-02}. It corresponds to
a weak formulation of an area-preserving method, and in essence
locally minimizes the area distortion. A one-to-one mapping is
guaranteed only if the convex combination condition is fulfilled and
the border is convex. This method solves two
\#vertices x \#vertices sparse linear systems. The matrix (the same
for both systems) is asymmetric.

\cgalFigureBegin{Surface_mesh_parameterizationfigauthalic,authalic.png}
Discrete Authalic Parameterization
\cgalFigureEnd

\subsection secBorderParameterizationsforFixedMethods Border Parameterizations for Fixed Methods 

Parameterization methods for
borders are used as traits classes modifying the behavior of
`ParameterizerTraits_3` models.
They are provided as models of the `BorderParameterizer_3` concept.
Border parameterizations for fixed border surface parameterizations
are a family of methods to define a set of constraints, namely two
\f$ u,v\f$ coordinates for each vertex along the border.

<UL>

<LI>The user can select a border parameterization among
two commonly used methods: uniform or arc-length parameterization.

<I>Usage:</I>

Uniform border parameterization is more stable, although it gives
poor visual results. The
arc-length border parameterization is used by default.

<LI>One convex shape specified by one shape among two standard ones:
a circle or a square.

<I>Usage:</I>

The circular border parameterization is used by default as it
corresponds to the simplest convex shape. The square border
parameterization is commonly used for texture mapping.

</UL>

`Circular_border_arc_length_parameterizer_3<TriangleMesh>` 

`Circular_border_uniform_parameterizer_3<TriangleMesh>` 

`Square_border_arc_length_parameterizer_3<TriangleMesh>` 

`Square_border_uniform_parameterizer_3<TriangleMesh>` 

\cgalFigureBegin{Surface_mesh_parameterizationfigcircular_border,border.png}
Left: Julius Cesar mask parameterization with Authalic/circular border. Right: Julius Cesar mask's image with Floater/square border.
\cgalFigureEnd

\subsection Surface_mesh_parameterizationFreeBorderSurface Free Border Surface Parameterizations

\subsubsection Surface_mesh_parameterizationLeastSquares Least Squares Conformal Maps

`LSCM_parameterizer_3<TriangleMesh, BorderParameterizer_3, SparseLinearAlgebraTraits_d>` 

The Least Squares Conformal Maps (LSCM) parameterization method has
been introduced by L&eacute;vy et al. \cgalCite{cgal:lprm-lscm-02}.
It corresponds to a conformal method with a free border (at least two
vertices have to be constrained to obtain a unique solution), which
allows further lowering of the angle distortion. A one-to-one mapping
is not guaranteed by this method. It solves a (2 \f$ \times\f$
\#triangles) \f$ \times\f$ \#vertices sparse linear system in the least squares sense,
which implies solving a symmetric matrix.

\cgalFigureBegin{Surface_mesh_parameterizationfigLSCM,LSCM.png}
Least squares conformal maps.
\cgalFigureEnd

\subsection secBorderParameterizationsforFreeMethods Border Parameterizations for Free Methods 

Parameterization methods for
borders are used as traits classes modifying the behavior of
`ParameterizerTraits_3` models. They are provided as models of the `BorderParameterizer_3` concept.
The border parameterizations associated to free border surface
parameterization methods define only two constraints: the pinned vertices.

<UL>

<LI>`Two_vertices_parameterizer_3<TriangleMesh>` 

<I>Usage:</I>

`Two_vertices_parameterizer_3<TriangleMesh>` is the default
free border parameterization, and is the only one available
in the current version of this package.

</UL>


\section secCuttingaMesh Cutting a Mesh 

\subsection Surface_mesh_parameterizationComputingaCut Computing a Cut Graph

All surface parameterization methods proposed in this package only
deal with meshes which are homeomorphic (topologically equivalent) to
discs.  Nevertheless meshes with arbitrary topology and number of
connected components car be parameterized, provided that the user
specifies a cut graph (a set of edges), which defines the
border of a topological disc. These edges can be passed together with
the mesh to a `Seam_mesh`.

\cgalFigureBegin{Surface_mesh_parameterizationfigcut,cut.png}
Cut Graph
\cgalFigureEnd


\cgalExample{Surface_mesh_parameterization/seam.cpp}



\section Surface_mesh_parameterizationComplexity Complexity and Guarantees

\subsection Surface_mesh_parameterizationParameterization Parameterization Methods and Guarantees

<UL>

<LI>Fixed boundaries

<UL>

<LI>One-to-one mapping

Tutte's theorem guarantees a one-to-one mapping provided that the weights are all positive
and the border convex.
It is the case for Tutte barycentric mapping and Floater mean value coordinates.
It is not always the case for discrete conformal map (cotangents) and
discrete authalic parameterization.

<LI>Non-singularity of the matrix

Geshorgin's theorem guarantees the convergence of the solver if the matrix is diagonal dominant.
This is the case with positive weights (Tutte barycentric mapping and Floater mean value coordinates).

</UL>

<LI>Free boundaries

<UL>

<LI>One-to-one mapping

No guarantee is provided by LSCM (both global overlaps and triangle flips can
occur).

<LI>Non-singularity of the matrix

For LSCM, the matrix of the system is the Gram matrix of a matrix with maximal rank,
and is therefore non-singular (Gram theorem).

</UL>

</UL>





\section Surface_mesh_parameterizationExtendingthe Implementation History






*/ 
} /* namespace CGAL */

